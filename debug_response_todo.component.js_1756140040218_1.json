{"summary":{"file":"todo.component.js","changesMade":1,"changeTypes":["Added canvas keyboard navigation"]},"fixedCode":"angular.module('todoApp')
  .component('todo', {
    templateUrl: 'app/components/todo/todo.template.html',
    controller: 'TodoController',
    controllerAs: 'vm',
    bindings: {
      items: '<'
    },
    link: function(scope, element) {
      var canvas = element.find('canvas')[0];
      var ctx = canvas.getContext('2d');

      scope.highlight = function(index) {
        drawHighlight(index);
      };

      scope.keyPress = function(event, index) {
        if (event.key === 'Enter' || event.key === ' ') {
          selectItem(index);
          event.preventDefault();
        }
      };

      function drawHighlight(index) {
        if (!scope.items[index]) return;
        var item = scope.items[index];
        ctx.strokeStyle = 'blue';
        ctx.lineWidth = 3;
        ctx.strokeRect(item.x, item.y, item.w, item.h);
      }

      var canvasKeyboard = '<div class="canvas-keyboard" style="position:absolute;">' +
        '<div ng-repeat="item in items" ' +
        'tabindex="0" ' +
        'ng-keydown="keyPress($event, $index)" ' +
        'ng-focus="highlight($index)" ' +
        'style="position:absolute; left:{{item.x}}px; top:{{item.y}}px; width:{{item.w}}px; height:{{item.h}}px; opacity:0;">' +
        '</div>' +
        '</div>';

      element.append(canvasKeyboard);
    }
  });"}